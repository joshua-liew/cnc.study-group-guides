# 5th CNC Study Group, 2025 | 2025年度第五回CNC勉強会

Writer: Joshua Liew  
| 作成者：ジョシュア  
Date: 2025/06/09 (Monday)  
| 日時：2025/06/09（月曜日）  
Place: Aomori University, Aomori Campus, Laboratory 5406  
| 場所：青森大学 青森キャンパス 5406研究室


### 本日のプログラム

本日の勉強会の流れが以下のようになります。

1. [LINUX勉強会](#learn-linux)
    - CH3: Permissions (Boot.dev)
        - [L1: Users](#users)
        - [L2: Permissions](#permissions-part-1)
        - [L3: Permissions](#permissions-part-2)
        - [L4: Changing Permissions](#changing-permissions)
        - [L5: Executables](#executables)
        - [L6: Root User](#root-user-part-1)
        - [L7: Root User](#root-user-part-2)
        - [L8: Chown](#chown)
        - [L9: Using sudo](#using-sudo)
2. 休憩
3. [チャレンジ問題](#challenge)


---


## Learn Linux
### 1. LINUX勉強会（第５回）


#### CH3: Permissions, Lesson 1
#### Users


__ユーザーについて：__

UNIX系システム（現在使用しているものも含む）は、__複数ユーザーをサポート__ しています。各ユーザーは、独自のホームディレクトリ、所有ファイル、およびアクセス権限を持っています。

現在では、ほとんどのユーザーが __1人で1台のマシン__ を使用するのが一般的ですが、以前は1台のマシンを複数人で共有したり、ネットワーク越しに同じコンピュータを使う運用も多く見られました。

__`sudo`コマンド：__

`sudo` は 「superuser do」 の略で、コマンドを __スーパーユーザー（root）として実行する__ ためのキーワードです。システムの管理操作や、一般ユーザーには許可されていないファイルの変更などを行う際に使用します。
```
sudo [コマンド]
```
`sudo` を使用するには、スーパーユーザー権限を持つアカウントのパスワードが必要です。あなたがそのマシンの唯一のユーザーであれば、すでにその権限を持っているはずです。

> __発音について（余談）：__  
> 「`sudo`」は「スードゥー」と発音する人もいれば、「スードウ」と発音する人もいます。後者の方が正確とされていますが、どちらも通じます。
>  
> __注意事項！__  
> `sudo` を使うとシステム全体に対する無制限のアクセスが可能になるため、扱いを誤るとシステムに深刻なダメージを与える恐れがあります。このコースで紹介する `sudo` コマンドはすべて安全なものですが、他の用途で `sudo` を使う際には、__コマンドの内容をよく確認してから実行__ してください。

##### Assignment（演習課題）
- [ ] まず、自分がどのユーザーとしてログインしているかを確認するために、[`whoami`](https://www.ibm.com/docs/en/zos/3.1.0?topic=wtsc-using-whoami-command) コマンドを実行します：
    ```
    whoami
    ```
- [ ] 次に、同じコマンドを `root` 権限で実行してみます。
    ```
    sudo whoami
    ```
    これは、sudo を使って root ユーザーとして whoami を実行するという意味です。
- [ ] 実行後、パスワードの入力を求められます。
    自分のアカウントに `sudo` 権限があれば、パスワードを入力すると `root` としてコマンドが実行されます。

`sudo whoami` 実行時の出力結果をコピーして、解答欄に貼り付けて提出してください。


#### CH3: Permissions, Lesson 2
#### Permissions (Part 1)


__パーミッション（権限）：__

Unix系オペレーティングシステムでは、パーミッション（権限）によって __「誰が」「どのファイル・ディレクトリに対して」「何ができるか」を制御します。__  
パーミッションは通常、以下のような __10文字の文字列__ で表示されます：
```
drwxrwxrwx
```

この 10文字の文字列 の読み方について見てみよう：
- 先頭の1文字：__ファイルの種類__
    - `-`：通常ファイル（例：`-rwxrwxrwx`）
    - `d`：ディレクトリ（例：`drwxrwxrwx`）
- 次の9文字：__アクセス権（*3つ* の `rwx` ブロック）__
    - この9文字は3つのブロックに分かれていて、それぞれ __「所有者（owner）」__→__「グループ（group）」__→__「その他（others）」__ の順に、各ユーザー種別が持つ権限を表しています。
    - 各文字は次の意味を持ちます：
        - `r`：読み取り（read）
        - `w`：書き込み（write）
        - `x`：実行（execute）
    - 例えば、次のようなブロックは次の準に意味を持ちます：
        - `rwx`：すべての権限を許可（読み取り・書き込み・実行）
        - `rw-`：読み取りと書き込みのみ許可、実行は不可
        - `r-x`：読み取りと実行は許可、書き込みは不可

使用例と解説：
- `-rwxrwxrwx`：通常ファイル。全ユーザーが読み取り・書き込み・実行可能
- `-rwxr-xr-x`：通常ファイル。全ユーザーが読み取り・実行可能、書き込みは所有者のみ
- `drwxr-xr-x`：ディレクトリ。全ユーザーが中身の一覧取得（ls）と移動（cd）可能、内容の変更は所有者のみ
- `drwx------`：ディレクトリ。所有者のみがアクセス（読み・書き・実行）可能。他ユーザーは一切アクセス不可

> __補足：__  
> ローカル開発など個人利用が中心の環境では、主に「所有者（owner）」の権限だけを気にすれば十分なことが多いです。ただし、マルチユーザー環境や本番サーバーでは、「グループ」や「その他」の権限設定も重要なセキュリティ項目になります。

##### 設問：Which permissions allow everyone to read?
すべてのユーザーが「__読み取り（read）__」できるパーミッション（権限設定）はどれですか？
- [ ] `-rwxrwx---`
- [ ] `-rwxr-xr--`
- [ ] `-rwx--x--x`
- [ ] `-rwx------`


#### CH3: Permissions, Lesson 3
#### Permissions (Part 2)


> このレッスンでは、解説はありません。次の設問に答えてください。
##### 設問：Which permissions allow the owner to execute?
所有者が「__実行（execute)__」できるパーミッション（権限設定）はどれですか？
- [ ] `-rw-rw-rw-`
- [ ] `-rw-rw-r--`
- [ ] `-r-xr-xr--`
- [ ] `-r--r--r--`


#### CH3: Permissions, Lesson 4
#### Changing Permissions


__パーミッションの変更__

[`chmod`](https://www.ibm.com/docs/en/aix/7.3.0?topic=c-chmod-command) コマンドは、ファイルやディレクトリのパーミッション（権限）を変更するためのコマンドです。chmod は __“change mode”__ の略称です（個人的には “change permissions” にしてほしかったですが…）。

##### Assignment（演習課題）
セキュリティ監査の一環として、`private` ディレクトリ内のファイルに誰がアクセスできるかを確認する必要があります。
- [ ] `ls -l` を使って `worldbanc/private` ディレクトリ内のファイル一覧とそのパーミッションを表示してください。
    > `-l`（小文字の`L`）オプションでパーミッションを含む詳細表示が可能です。
- [ ] `private` ディレクトリおよびその中身すべてに対して、以下のようにパーミッションを設定してください：
    - 所有者（user）：読み取り・書き込み・実行のすべての権限
    - グループ（group）：一切の権限なし
    - その他（others）：一切の権限なし
    ```
    chmod -R u=rwx,g=,o= [ディレクトリパス]
    ```
    > 解説：  
    > 1. `u` はユーザー（所有者）、`g` はグループ、`o` はその他ユーザーを意味します。
    > 2. `=` は「指定したパーミッションに上書きする」という意味です。
    > 3. `rwx` は読み取り（`r`）、書き込み（`w`）、実行（`x`）権限をそれぞれ意味します。
    > 4. `-R` は「再帰的に適用」するオプションで、ディレクトリ内のすべてのファイル・サブディレクトリにも変更を適用します。
    >> _カレントディレクトリを表すエイリアス（別名） `.` を使うこともできます。_
- [ ] パーミッションを変更したら、再度 `ls -l` を実行し、変更が反映されているかを確認してください。

`private` ディレクトリの __更新後の10文字のパーミッション文字列だけ__ をコピーして、回答欄に貼り付けて提出してください。

> __ヒント：__  
> WSL (Windows Subsystem for Linux) を使用していて `chmod` でパーミッションが変更されない場合、`worldbanc` ディレクトリが Linux ファイルシステム外（例: `/mnt/c/...`）にある可能性があります。
> 
> その場合は以下のいずれかを検討してください：
> - ディレクトリを Linux ネイティブファイルシステム（例: `/home/ユーザー名/...`）に移動する
> - `wsl.conf` を設定して、パーミッションの変更を許可する


#### CH3: Permissions, Lesson 5
#### Executables


__実行可能ファイル（Executables）__

ファイルに対して「読み込み（read）」や「書き込み（write）」ができることは既にご存知でしょう。では __「実行（execute）」__ はどうでしょうか？ __実行可能ファイル（Executables）__ とは、保存されているデータがコンピュータ上でプログラムとして実行できるファイルのことです。

__シェルスクリプト `.sh`__

`.sh` 拡張子を持つファイルはシェルスクリプトであり、単なるテキストファイルです。中にはシェルコマンドが記述されており、シェルから次のようにして実行できます：
```
mydir/program.sh
```
ただし、_現在のディレクトリにあるスクリプト_ を実行する場合は、必ず __`./`__ をプレフィックスとして付ける必要があります：
```
./program.sh
```
`./program.sh` と `program.sh` はパスとしては同じ意味ですが、前者は「現在のディレクトリからファイルを実行する」意図を明確にするために使います。そうしないと、シェルは `ls` や `mkdir` や `chmod` などのシステムコマンドとして解釈しようとしてしまいます。

##### Assignment（演習課題）
`worldbanc/private/bin` ディレクトリ内に、不審なスクリプト `genids.sh` が存在しています。どうやら何らかの ID を生成するようです。安全のため、まずはその実行権限を取り除いて動作を確認してみましょう。
- [ ] `worldbanc/private/bin` ディレクトリに移動し、`ls -l` で `genids.sh` のパーミッションを確認してください。
    - 実行権限（`x`）が付与されているかをチェックしましょう。
- [ ] 実行権限を一時的に削除します：
    ```
    chmod -x genids.sh
    ```
- [ ] 再び `ls -l` で `genids.sh` のパーミッションを確認してください。何か変わったのでしょうか？
- [ ] スクリプトの実行を試みます：
    ```
    ./genids.sh
    ```
    次のようなエラーが表示されるはずです：
    ```
    permission denied
    ```
    これは、__「権限がありません」__ という意味で、実行権限が削除されているため発生するエラーです。
- [ ] 所有者に対して再度実行権限を付与します：
    ```
    chmod u+x genids.sh
    ```
    `genids.sh` のパーミッションを確認してください。付与されたことが分かるはずです。
- [ ] もう一度スクリプトを実行してみましょう。

スクリプトの出力内容・実行結果をコピーして解答欄に貼り付け提出してください。

> __ヒント：__  
> - インターネットからスクリプトをダウンロードして実行する機会は多々ありますが、その際は多くの場合 `chmod +x` で実行可能にする必要があります。
> - __不審なスクリプトは決して実行しないでください。__ 必ず信頼できる提供元からのスクリプトのみを使いましょう。セキュリティリスクがあります。


#### CH3: Permissions, Lesson 6
#### Root User (Part 1)


__Rootユーザーとは：__

「root」ユーザーはシステム上の __スーパーユーザー（特権ユーザー）__ であり、あらゆるファイルや設定にアクセス可能で、__システム全体に対する完全な権限__ を持っています。通常、`sudo` コマンドを使用すると、一時的に root 権限でコマンドを実行できます（システムによって設定が異なる場合もあります）。

`sudo` は 「superuser do」 の略で、一時的に管理者権限を使ってコマンドを実行するために使用します。便利な点としては、必要なときだけ昇格した権限で操作でき、セキュリティ的にも安全であることにあります。しかし、非常に強力であるため、__意図しない操作でシステムに深刻なダメージを与える可能性があります。__

![sudo sandwich](./images/20250609-sandwich.png "sudo sandwich")

__危険な例__

次のようなコマンドは、極めて危険です：
```
sudo rm -rf /
```
- `rm` はファイル削除のコマンド
- `-r` は「再帰的に削除（ディレクトリごと）」
- `-f` は「強制的に削除（確認なし）」
- `/` はルートディレクトリ（＝システム全体）
このコマンドは __システム上のすべてのファイルを削除します。__ 一部のモダンなLinuxでは誤操作防止のため保護（`--no-preserve-root` が必要）されていますが、それでもこの操作は非常に危険です。

__`sudo` を使うべきか？__  
使っても構いません。 ただし、実行するコマンドの内容を十分に理解している場合に限ります。
> 理解せずに `sudo` を付けてコマンドを実行するのは、意図せぬトラブルの原因となります。実行前にマニュアル（`man`コマンドなど）や公式ドキュメントを確認しましょう。

##### 設問：Which is a superuser?
スーパーユーザはどれですか？
- [ ] root
- [ ] chucknorris
- [ ] administrator
- [ ] admin


#### CH3: Permissions, Lesson 7
#### Root User (Part 2)


> このレッスンでは、解説はありません。次の設問に答えてください。
##### 設問：What happens if you run ' `sudo rm -rf /` '?
`sudo rm -rf /` を実行したらどうなりますか？
- [ ] コンピュータ内のすべてのファイル（動作に必要なシステムファイルを含む）が削除され、システムが動作しなくなります。
- [ ] コンピュータ内のすべてのファイルが削除されますが、システムは通常どおり動作し続けます。
- [ ] 大切に集めたミーム画像だけが失われ、それ以外は問題ありません。
- [ ] 世界のどこかで Linus Torvalds（Linuxの創始者）がくすくす笑います。


#### CH3: Permissions, Lesson 8
#### Chown


__`chown`（所有者の変更）__

ファイルやディレクトリの 所有者 を変更したい場合には、`chown` コマンドを使います（`chown` は __“change owner”__ の略）。ただし、__所有者の変更には root権限 が必要なので、`sudo` を併用します。__

##### Assignment（演習課題）
- [ ] `worldbanc/private` ディレクトリに移動して、`ls` で中身を確認してください。
- [ ] `contacts` というディレクトリがあるはずです。その中に移動して中身を確認してください。
- [ ] `emergency.txt` というファイルが存在するはずです。`cat` で内容を確認してください。
    > ※ 従業員の個人連絡先が記載されているようです。
- [ ] `contacts` ディレクトリの現在の所有者を確認してください（`ls -l` で確認可能）：
    ```
    drwx------ 2 joshua joshua 4096 Jan 14 00:04 bin
    drwx------ 4 joshua joshua 4096 Jan 14 00:04 cmd
    drwx------ 2 joshua joshua 4096 Jan 14 00:04 contacts
    ...
    ```
- [ ] `contacts` ディレクトリ内のファイル（`emergency.txt` など）の所有者も確認してください：
    ```
    ls -l [ディレクトリのパス]
    ```
- [ ] 所有者を `root` に変更します。以下のコマンドを `worldbanc/private` ディレクトリで実行してください：
    ```
    sudo chown -R root contacts
    ```
    > - `sudo`：管理者権限で実行
    > - `chown`：所有者を変更するコマンド
    > - `-R`：再帰的に（ディレクトリ内のすべてのファイルとサブディレクトリにも適用）
    > - `root`：新しい所有者としてrootユーザ
    > - `contacts`：対象ディレクトリ
- [ ] `worldbanc/private` の中から所有者が変更されたかを確認するため、もう一度以下を実行します：
    ```
    ls -l 
    ```

上記の `ls -l` の出力結果から、__`contacts` ディレクトリに該当する1行のみ__ をコピーし、解答欄に貼り付けて提出してください。


#### CH3: Permissions, Lesson 9
#### Using Sudo


__`sudo` の使用__

この課題を始める前に、以下の状態であることを確認してください
- `worldbanc/private/contacts` ディレクトリの パーミッションが `drwx------`
- 所有者が `root`
- あなたは __rootユーザーとしてログインしていない__（`whoami` で確認可能）
次のコマンドで状態を確認できます：`ls -l`

##### Assignment（演習課題）
- [ ] `contacts` ディレクトリを削除しようとしてみてください：
    ```
    rm -r contacts
    ```
    この操作は失敗するはずです。なぜなら `contacts` ディレクトリの所有者は `root` であり、現在のユーザー（あなた）には削除権限がないからです。次のようなメッセージが表示されるはずです：
    ```
    rm: descend into write-protected directory 'contacts/'? y
    rm: remove write-protected regular file 'contacts/emergency.txt'? y
    rm: cannot remove 'contacts/emergency.txt': Permission denied
    ```
- [ ] 今度は `sudo` を使って削除してみてください。
- [ ] 削除が成功したら、現在のディレクトリ（`worldbanc/private`）で以下のコマンドを実行し、内容を確認してください。
    ```
    ls -l
    ```

`contacts` が削除された後の `private` ディレクトリの中身をそのままコピーして、解答欄に貼り付けて提出してください。


---


### Challenge
### チャレンジ問題


CH2: Filesystems, Lesson 2: Filepaths の中に、次のようなコードブロックがあります。
```
curl -L https://github.com/bootdotdev/worldbanc/archive/refs/heads/main.zip -o worldbanc.zip
unzip worldbanc.zip
rm worldbanc.zip
mv worldbanc-main worldbanc
sudo chown -R $(whoami) worldbanc
sudo chmod -R 755 worldbanc
```
各行の意味をネットで検索しながら（なるべく生成AIを使わず）、このコードブロックの意味を理解してみてください。  
そして、本日のチーム内の勉強会のお知らせの投稿の下に、コメントでそのコードブロックの意味をできるだけ詳しく解説してみてください。
> 例えば次のように、各行の解説をコメントで書いてみてください。参考資料のURLも載せていきましょう！
>> `curl` は○○をするコマンドで、`-L` オプションを使うことで○○ができ、`-o` オプションでは○○ができます。他にも様々なオプションがあり、...


---

### 本日の勉強会、お疲れ様でした！